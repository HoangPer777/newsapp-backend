FROM eclipse-temurin:21-jdk-jammy

# Install Maven + curl
RUN apt-get update \
  && apt-get install -y --no-install-recommends maven curl \
  && rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /app

# Copy pom.xml and source code
COPY newsapp/pom.xml .
COPY newsapp/src ./src

# Expose port
EXPOSE 8080

# Set environment variables
ENV SPRING_PROFILES_ACTIVE=postgres
ENV SERVER_PORT=8080

# Run Spring Boot with DevTools enabled
# -e flag: pass environment variables, -it: interactive terminal
CMD ["mvn", "spring-boot:run", "-Dspring-boot.run.arguments=--server.port=8080"]